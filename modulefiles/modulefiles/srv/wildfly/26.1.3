#%Module1.0#####################################################################
##
## wildfly modulefile
##
proc ModulesHelp { } {
        global version prefix

        puts stderr "\twildfly - loads the WildFly application server environment"
        puts stderr "\n\tThis adds $prefix/* to several of the"
        puts stderr "\tenvironment variables."
        puts stderr "\n\tVersion $version\n"
}

module-whatis	"loads the WildFly 26.1.3.Final environment"

# for Tcl script use only
set	version		26.1.3
set	prefix		/opt/wildfly/$version

# WildFly 26.x requires Java 11 or 17
if { ![is-loaded java] } {
    module load java/17.0.17
}

setenv        JBOSS_HOME   $prefix
setenv        WILDFLY_HOME $prefix
prepend-path  PATH         $prefix/bin

# Create aliases for easy management
set-alias     wildfly-start      "$prefix/bin/standalone.sh"
set-alias     wildfly-start-bg   "$prefix/bin/standalone.sh > /dev/null 2>&1 &"
set-alias     wildfly-stop       "$prefix/bin/jboss-cli.sh --connect command=:shutdown"
set-alias     wildfly-domain     "$prefix/bin/domain.sh"
set-alias     wildfly-cli        "$prefix/bin/jboss-cli.sh"
set-alias     wildfly-logs       "tail -f $prefix/standalone/log/server.log"

# enable module versioning modulepath
#module use {~/modulefiles/wildfly/$version}
